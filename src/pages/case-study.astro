---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import HeroSection from '../components/HeroSection.astro';
import { getCollection } from 'astro:content';

const caseStudies = await getCollection('case-studies', ({ data }) => {
  return !data.draft;
});

// Sort case studies by published date (newest first)
caseStudies.sort((a, b) => new Date(b.data.publishedAt).getTime() - new Date(a.data.publishedAt).getTime());
---

<Layout title="Case Studies - A&H Solutions">
  <Header />
  <main>
    <HeroSection 
      title="Case Studies" 
      highlightText="Studies"
      description="See how our clients are achieving success with A&H Solutions."
    />
    
    <section class="py-16 bg-white dark:bg-gray-800">
      <div class="container-custom">
        {caseStudies.length > 0 ? (
          caseStudies.map((caseStudy, index) => (
            <div class="mb-24">
              <div class="grid md:grid-cols-2 gap-12 items-center mb-12">
                <div class={index % 2 === 1 ? 'order-2 md:order-1' : ''}>
                  {caseStudy.data.client && (
                    <span class="inline-block px-4 py-1 rounded-full bg-secondary-100 dark:bg-secondary-900 text-secondary-600 dark:text-secondary-300 font-medium text-sm mb-4">
                      {caseStudy.data.client.industry}
                    </span>
                  )}
                  <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">{caseStudy.data.title}</h2>
                  <p class="text-gray-600 dark:text-gray-300 mb-6">
                    {caseStudy.data.excerpt || caseStudy.data.description}
                  </p>
                  {caseStudy.data.results && caseStudy.data.results.metrics && (
                    <div class="flex flex-wrap gap-4 mb-6">
                      {caseStudy.data.results.metrics.map((metric) => (
                        <div class="flex items-center">
                          <svg class="w-5 h-5 text-primary-600 dark:text-primary-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                          </svg>
                          <span class="text-gray-700 dark:text-gray-300">{metric.label}: {metric.value}</span>
                        </div>
                      ))}
                    </div>
                  )}
                  <a href={`/case-studies/${caseStudy.slug}`} class="btn-primary">Read Full Case Study</a>
                </div>
                <div class={`rounded-lg overflow-hidden shadow-xl ${index % 2 === 1 ? 'order-1 md:order-2' : ''}`}>
                  {caseStudy.data.image ? (
                    <img src={caseStudy.data.image} alt={caseStudy.data.imageAlt || caseStudy.data.title} class="w-full h-auto" />
                  ) : (
                    <div class="w-full h-64 bg-gradient-to-br from-primary-500 to-secondary-500 flex items-center justify-center">
                      <span class="text-white text-xl font-semibold">{caseStudy.data.client?.name || 'Case Study'}</span>
                    </div>
                  )}
                </div>
              </div>
            </div>
          ))
        ) : (
          <div class="text-center py-16">
            <h3 class="text-2xl font-semibold text-gray-900 dark:text-white mb-4">Case Studies Coming Soon</h3>
            <p class="text-gray-600 dark:text-gray-300 mb-8 max-w-2xl mx-auto">
              We're currently working on documenting our successful client projects. Check back soon to see how we've helped businesses achieve their goals.
            </p>
            <a href="/contact" class="btn-primary">Discuss Your Project</a>
          </div>
        )}
        
        <div class="mt-16 text-center">
          <h3 class="text-2xl font-semibold text-gray-900 dark:text-white mb-4">Ready to achieve similar results?</h3>
          <p class="text-gray-600 dark:text-gray-300 mb-8 max-w-2xl mx-auto">
            Let A&H Solutions help transform your business with our proven expertise. Our team is ready to help you succeed.
          </p>
          <div class="flex flex-col sm:flex-row justify-center gap-4">
            <a href="/contact" class="btn-primary">Discuss Your Project</a>
            <a href="/company" class="btn-secondary">Learn About Us</a>
          </div>
        </div>
      </div>
    </section>
  </main>
  <Footer />
</Layout> 
